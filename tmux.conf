set -sg escape-time 0

# set-window-option -g mode-keys vi
setw -g mode-keys vi

# Easy config reload
bind-key R source-file ~/.tmux.conf \; display-message "tmux.conf reloaded."

# use vim-like keys for splits and windows
bind-key v split-window -h
bind-key s split-window -v
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

bind P paste-buffer

# Setup 'v' to begin selection as in Vim
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi y send -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"

# Update default binding of `Enter` to also use copy-pipe
unbind -T copy-mode-vi Enter
bind-key -T copy-mode-vi Enter send -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"

bind -n C-k clear-history
# bind k confirm kill-window
# bind K confirm kill-server
bind < resize-pane -L 1
bind > resize-pane -R 1
bind - resize-pane -D 1
bind + resize-pane -U 1
# set -g xterm-keys on
set -g default-terminal "xterm-256color-italic"
# set-window-option -g xterm-keys on
# set -g terminal-overrides "screen*:kLFT5=\eOD:kRIT5=\eOC:kUP5=\eOA:kDN5=\eOB:smkx@:rmkx@"


set -ga terminal-overrides ',*:Tc'
set -ga terminal-overrides '*:Ss=\E[%p1%d q:Se=\E[ q' # this is for the cursor shape
# set -ga terminal-overrides ',st*:kind@:kri@'
# set -ga terminal-overrides ',xterm-256color:Tc'




not_tmux="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?(g?(view|n?vim?x?)(diff)?|fzf)$'"
bind-key -n C-h if-shell "$not_tmux" "send-keys C-h"  "select-pane -L"
bind-key -n C-j if-shell "$not_tmux" "send-keys C-j"  "select-pane -D"
bind-key -n C-k if-shell "$not_tmux" "send-keys C-k"  "select-pane -U"
# bind-key -n C-l if-shell "$not_tmux" "send-keys C-l"  "select-pane -R"
# bind-key -n C-\ if-shell "$not_tmux" "send-keys C-\\" "select-pane -l"


# set -g default-terminal "tmux"
set -g visual-activity on
# set-option -g set-titles on
# set-option -g set-titles-string "#S / #W"


# # statusbar --------------------------------------------------------------

set -g status-interval 1
set -g status 'on'
# set -g status-position top
set -g status-bg 'colour235'
set -g status-justify 'centre'
set -g status-left-length '100'
set -g status-right-length '100'
set -g message-style fg='colour222',bg='colour238'
set -g message-command-style fg='colour222',bg='colour238'
set -g pane-border-style fg='colour238'
set -g pane-active-border-style fg='colour154'
setw -g window-status-activity-style fg='colour154',bg='colour235',none
setw -g window-status-separator ''
setw -g window-status-style fg='colour121',bg='colour235',none
set -g status-left '#[fg=colour232,bg=colour154] #S #[fg=colour154,bg=colour238,nobold,nounderscore,noitalics]~>#[fg=colour222,bg=colour238] #W #[fg=colour238,bg=colour235,nobold,nounderscore,noitalics]~>#[fg=colour121,bg=colour235] #(whoami) #[fg=colour154, bg=colour235]~>#[fg=colour121, bg=colour235] #(uptime  | cut -d " " -f 1,2,3) #[fg=colour235,bg=colour235,nobold,nounderscore,noitalics]:'
set -g status-right '#[fg=colour235,bg=colour235,nobold,nounderscore,noitalics]î‚²#[fg=colour121,bg=colour235] %r #[fg=colour154, bg=colour235]/#[fg=colour121, bg=colour235] %a #[fg=colour154, bg=colour235]|#[fg=colour121, bg=colour235] %Y #[fg=colour238,bg=colour235,nobold,nounderscore,noitalics]|#[fg=colour222,bg=colour238] #H #[fg=colour154,bg=colour238,nobold,nounderscore,noitalics]|#[fg=colour232,bg=colour154] #(rainbarf --battery --remaining --bright --rgb) '
setw -g window-status-format '#[fg=colour235,bg=colour235,nobold,nounderscore,noitalics]<<#[default] #I >> #W #[fg=colour235,bg=colour235,nobold,nounderscore,noitalics]>>'
setw -g window-status-current-format '#[fg=colour235,bg=colour238,nobold,nounderscore,noitalics]<~#[fg=colour154,bg=colour238] #I >> #W << #F #[fg=colour235,bg=colour238,nobold,nounderscore,noitalics]~>'

